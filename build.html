<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Build &mdash; Lightmetrica Version 3  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Managing experiments" href="managing_experiment.html" />
    <link rel="prev" title="Changelog" href="changelog.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Lightmetrica Version 3
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Build</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-framework">Installing framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-pre-built-binaries">Using pre-built binaries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installing-conda-package">Installing conda package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-plugins">Building plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-from-source">Building from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installing-dependencies">Installing dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-framework">Building framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-source-built-framework-as-external-library">Using source-built framework as external library</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#editing-documentation">Editing documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-jupyter-notebook">Working with Jupyter notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-docker-containers">Working with Docker containers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dockerfile-for-build-and-tests">Dockerfile for build and tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dockerfile-only-with-dependencies">Dockerfile only with dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="managing_experiment.html">Managing experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_rendering.html">Basic rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending_framework.html">Extending framework</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_system.html">Build System</a></li>
<li class="toctree-l1"><a class="reference internal" href="component.html">Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_binding.html">Python binding</a></li>
<li class="toctree-l1"><a class="reference internal" href="path_sampling.html">Path sampling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples and tests</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="test.html">Tests in Lightmetrica</a></li>
<li class="toctree-l1"><a class="reference internal" href="example.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="functest.html">Functional tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="perftest.html">Performance tests</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="component_ref.html">Built-in component reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_ref.html">API reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Lightmetrica Version 3</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Build</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/build.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="build">
<span id="id1"></span><h1>Build<a class="headerlink" href="#build" title="Permalink to this headline"></a></h1>
<p>This section describes build process of Lightmetrica.</p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"></a></h2>
<p>We recommend to use <a class="reference external" href="https://docs.conda.io/en/latest/miniconda.html">miniconda</a> to manage build and runtime environment of the framework.</p>
</div>
<div class="section" id="installing-framework">
<h2>Installing framework<a class="headerlink" href="#installing-framework" title="Permalink to this headline"></a></h2>
<p>There are two different options to use the framework. You want to choose either of them according to your requirements.</p>
<ol class="arabic simple">
<li><p><strong>Using pre-built binaries</strong>. This option is suitable when you want to use the framework as a renderer without user-defined extensions, or when you want to develope your own plugins but you don’t need to extend the framework itself.</p></li>
<li><p><strong>Bulilding from source</strong>. This option is suitable for for the framework developers, or for the situation where you have the requirements that cannot be achieved only by plugins. If you want to use the framework for the research purpose, we would recommend to use this option.</p></li>
</ol>
</div>
<div class="section" id="using-pre-built-binaries">
<h2>Using pre-built binaries<a class="headerlink" href="#using-pre-built-binaries" title="Permalink to this headline"></a></h2>
<div class="section" id="installing-conda-package">
<h3>Installing conda package<a class="headerlink" href="#installing-conda-package" title="Permalink to this headline"></a></h3>
<p>We distribute the pre-built binaries of the framework as a conda package.
You can easily install the framework including dependencies by conda install command.
This option is especially useful when you don’t want to modify the framework itself.
To install the framework, you just need the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda create -n lm3 <span class="nv">python</span><span class="o">=</span><span class="m">3</span>.7
<span class="gp">$ </span>conda activate lm3
<span class="gp">$ </span>conda install lightmetrica -c hi2p-perim -c conda-forge
</pre></div>
</div>
<p>The first line create a new conda environment with Python 3.7.
Currently, the pre-built package only supports Python 3.7 and other Python versions are not supported.
If you want to use different Python version, consider to build the framework by yourself.</p>
<p>If you could successfully install the framework, executing the following commands will get you the information of the framework. Note that python command must be executed in the same conda environment.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python
<span class="go">&gt;&gt;&gt; import lightmetrica as lm</span>
<span class="go">&gt;&gt;&gt; lm.init()</span>
<span class="go">&gt;&gt;&gt; lm.info()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">-c</span> <span class="pre">hi2p-perim</span></code> option must precedes <cite>-c conda-forge</cite> option, since <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span></code> prioritizes the first channel specified when the packages with the same name are found in both channels.</p>
</div>
</div>
<div class="section" id="building-plugins">
<h3>Building plugins<a class="headerlink" href="#building-plugins" title="Permalink to this headline"></a></h3>
<p>We can also easily build Lightmetrica plugins using the pre-built binaries. To do this, you need CMake (&gt;=3.10) and build environments according to the platform: Visual Studio 2017 or 2019 (Windows) and GCC 7 (Linux).</p>
<p>The package is shipped with development files for the plugin development. The distributed binaries are built with Visual Studio 2017 or 2019 (Windows) and GCC 7 (Linux).
Although you can develop plugins as long as the ABI compatibility allows,
we highly recommend to use the compiler with the same version in which the framework is built.
If you want to use compilers that might break ABI compatibility for instance due to the change of compiler versions, consider to build the framework by yourself.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As a development goes by, you might want to change the pre-built binaries to your own build.
In this case, we highly recommends to create a fresh new conda environment
to avoid serious dependency issues that might be caused by having both builds in the same environment.</p>
</div>
<p>To build a plugin, you want to make a <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file like:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span> <span class="s">3.10</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">test_plugin</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">lightmetrica</span> <span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">add_library</span><span class="p">(</span><span class="s">test_plugin</span> <span class="s">MODULE</span> <span class="s2">&quot;test_plugin.cpp&quot;</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">test_plugin</span> <span class="s">PRIVATE</span> <span class="s">lightmetrica::liblm</span><span class="p">)</span>
</pre></div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">find_package</span></code> command to find <code class="docutils literal notranslate"><span class="pre">lightmetrica</span></code> package.
The command automatically finds the corresponding pre-build binary installed in the conda environment. <code class="docutils literal notranslate"><span class="pre">target_link_libraries</span></code> command specifies the target to which the plugin is linked. Here, we specify <code class="docutils literal notranslate"><span class="pre">lightmetrica::liblm</span></code> target. Then we can build the plugin with the following comamnds.</p>
<p>In Windows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> &lt;plugin <span class="nb">source</span> directory&gt;
<span class="gp">$ </span>mkdir build
<span class="gp">$ </span><span class="nb">cd</span> build
<span class="gp">$ </span>cmake -G <span class="s2">&quot;Visual Studio 15 2017 Win64&quot;</span> ..
<span class="go">// or $ cmake -G &quot;Visual Studio 16 2019&quot; -T v141 ..</span>
<span class="gp">$ </span>start test_plugin.sln
</pre></div>
</div>
<p>In Linux:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> &lt;plugin <span class="nb">source</span> directory&gt;
<span class="gp">$ </span>mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
<span class="gp">$ </span>cmake -DCMAKE_BUILD_TYPE<span class="o">=</span>Release ..
<span class="gp">$ </span>make -j
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important to execute the aforementioned commands from the activated conda environment.
Otherwise CMake cannot find the <code class="docutils literal notranslate"><span class="pre">lightmetrica</span></code> package installed in the environment.
If you are using Windows and you want to apply the configuration of the environment also in Visual Studio, use <code class="docutils literal notranslate"><span class="pre">start</span></code> command from the terminal to launch the IDE.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The option <code class="docutils literal notranslate"><span class="pre">-DCMAKE_BUILD_TYPE=Release</span></code> is necessary because
CMake’s default is <code class="docutils literal notranslate"><span class="pre">Debug</span></code> in Linux environment.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Visual Studio 2019 is supported by <code class="docutils literal notranslate"><span class="pre">v141</span></code> toolset. You need to install it from the VS installer.
The newer toolsets might not work due to the binary incompatibilities.</p>
</div>
</div>
</div>
<div class="section" id="building-from-source">
<span id="id2"></span><h2>Building from source<a class="headerlink" href="#building-from-source" title="Permalink to this headline"></a></h2>
<div class="section" id="installing-dependencies">
<h3>Installing dependencies<a class="headerlink" href="#installing-dependencies" title="Permalink to this headline"></a></h3>
<p>We distribute the external dependencies as conda packages.
We recommend to use a separated environment to manage the build environment.
The dependent packages are written in <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code>.
From the file, you can create and activate a new conda environment named <code class="docutils literal notranslate"><span class="pre">lm3_dev</span></code> with the following commands. All commands in the following instruction assume the activation of the <code class="docutils literal notranslate"><span class="pre">lm3_dev</span></code> environment.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda env create -f environment.yml
<span class="gp">$ </span>conda activate lm3_dev
</pre></div>
</div>
<p>If you want to create the environment with an original name, you can use <code class="docutils literal notranslate"><span class="pre">-n</span></code> option.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda env create -n &lt;preferred name&gt; -f environment.yml
<span class="gp">$ </span>conda activate &lt;preferred name&gt;
</pre></div>
</div>
</div>
<div class="section" id="building-framework">
<h3>Building framework<a class="headerlink" href="#building-framework" title="Permalink to this headline"></a></h3>
<p>Before building, you want to clone the repository to your local directory. Be careful to use <code class="docutils literal notranslate"><span class="pre">--recursive</span></code> option since the repository contains submodules.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git clone --recursive git@github.com:lightmetrica/lightmetrica-v3.git
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you already cloned the repository without <code class="docutils literal notranslate"><span class="pre">--recursive</span></code> option, you must initialize the submodules with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">init</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">update</span></code> commands.</p>
</div>
<p><strong>Windows</strong>. You can generate solution for Visual Studio with the following commands.
To build Python binding, be sure to activate the previously-created Python environment and start Visual Studio from the same shell.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> &lt;<span class="nb">source</span> directory&gt;
<span class="gp">$ </span>mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
<span class="gp">$ </span>cmake -G <span class="s2">&quot;Visual Studio 15 2017 Win64&quot;</span> ..
<span class="gp">$ </span>start lightmetrica.sln
</pre></div>
</div>
<p><strong>Linux</strong>. The following commands generates the binaries under <code class="docutils literal notranslate"><span class="pre">build/bin</span></code> directory.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
<span class="gp">$ </span>cmake -DCMAKE_BUILD_TYPE<span class="o">=</span>Release ..
<span class="gp">$ </span>make -j
</pre></div>
</div>
<p>Alternatively, execute the following command to build and install Lightmetrica to your system. If you want to change installation directory, add <code class="docutils literal notranslate"><span class="pre">-DCMAKE_INSTALL_PREFIX=&lt;install</span> <span class="pre">dir&gt;</span></code> to the previous <code class="docutils literal notranslate"><span class="pre">cmake</span></code> command.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake --build build --target install
</pre></div>
</div>
</div>
<div class="section" id="using-source-built-framework-as-external-library">
<h3>Using source-built framework as external library<a class="headerlink" href="#using-source-built-framework-as-external-library" title="Permalink to this headline"></a></h3>
<p>If you want to use the source-built version of Lightmetrica in your project,
you can directly include the source directory of Lightmetrica using <code class="docutils literal notranslate"><span class="pre">add_subdirectory</span></code> command in your <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file. This approach is useful when you want to maintain your experiments outside of the framework repository while modifying the framework itself.</p>
<p>The following <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> shows minimum example of this approach.
Once you include the directory, you can use <code class="docutils literal notranslate"><span class="pre">lightmetrica::liblm</span></code> target to link the main library <code class="docutils literal notranslate"><span class="pre">lightmetrica::liblm</span></code> to your application or plugin.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span> <span class="s">3.10</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">your_renderer</span><span class="p">)</span>
<span class="hll"><span class="nb">add_subdirectory</span><span class="p">(</span><span class="s">lightmetrica</span><span class="p">)</span>
</span><span class="nb">add_executable</span><span class="p">(</span><span class="s">your_renderer</span> <span class="s2">&quot;your_renderer.cpp&quot;</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">your_renderer</span> <span class="s">PRIVATE</span> <span class="s">lightmetrica::liblm</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="editing-documentation">
<h2>Editing documentation<a class="headerlink" href="#editing-documentation" title="Permalink to this headline"></a></h2>
<p>It is useful to use sphinx-autobuild plugin if you want to get immediate visual update on editing.
With the following commands, you can access the documentation from <code class="docutils literal notranslate"><span class="pre">http://127.0.0.1:8000</span></code>. Note that the documentation extracted from C++ sources are not updated automatically. Make sure to execute <code class="docutils literal notranslate"><span class="pre">doxygen</span></code> command again if you want to update the information.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> &lt;<span class="nb">source</span> directory&gt;
<span class="gp">$ </span><span class="nb">cd</span> doc <span class="o">&amp;&amp;</span> mkdir _build <span class="o">&amp;&amp;</span> doxygen
<span class="gp">$ </span><span class="nb">cd</span> -
<span class="gp">$ </span>sphinx-autobuild --watch src doc doc/_build/html
</pre></div>
</div>
<p>Note that some documentation is generated from the executed Jupyter notebooks.
To obtain a complete documentation, you want to execute the notebooks in <code class="docutils literal notranslate"><span class="pre">functest</span></code> directory
and copy the executed notebooks to the <code class="docutils literal notranslate"><span class="pre">doc/executed_functest</span></code> directory.
For detail, please find <code class="docutils literal notranslate"><span class="pre">.travis.yml</span></code> file.</p>
</div>
<div class="section" id="working-with-jupyter-notebook">
<span id="id3"></span><h2>Working with Jupyter notebook<a class="headerlink" href="#working-with-jupyter-notebook" title="Permalink to this headline"></a></h2>
<p>Move to your working directory, and execute Jupyter notebook</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span> &lt;working directory&gt;
<span class="gp">$ </span>jupyter-notebook
</pre></div>
</div>
<p>Example of starting cells, where [1] loads <code class="docutils literal notranslate"><span class="pre">lightmetrica_jupyter</span></code> extension
and [2] copies Release binaries to temporary directory
and [3] imports the framework as an alias <code class="docutils literal notranslate"><span class="pre">lm</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">sys</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;Lightmetrica root directory&gt;&#39;</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;Lightmetrica binary directory&gt;&#39;</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="o">%</span><span class="k">load_ext</span> lightmetrica_jupyter
<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">lightmetrica</span> <span class="k">as</span> <span class="nn">lm</span>
</pre></div>
</div>
<p>We provide Jupyter notebook friendly implementation of <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">lm::Logger</span></code> and <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">lm::Progress</span></code>.
To use the recommended settings, use <code class="docutils literal notranslate"><span class="pre">jupyter_init_config()</span></code> function and append the return value
to the argument of <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">lm::init()</span></code> function.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">lightmetrica_jupyter</span> <span class="kn">import</span> <span class="n">jupyter_init_config</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">lm</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="s1">&#39;user::default&#39;</span><span class="p">,</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">other</span> <span class="n">configuration</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">**</span><span class="n">jupyter_init_config</span><span class="p">()})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>IPython kernel locks the loaded c extensions
and prevents the shared libraries of the framework from being recompiled,
until the kernel is shut down.
Thus if you want to rebuild already-loaded c extension you need to first shutdown the kernel.</p>
</div>
</div>
<div class="section" id="working-with-docker-containers">
<h2>Working with Docker containers<a class="headerlink" href="#working-with-docker-containers" title="Permalink to this headline"></a></h2>
<p>We prepared Dockerfiles to setup linux environments for several use-cases.</p>
<div class="section" id="dockerfile-for-build-and-tests">
<h3>Dockerfile for build and tests<a class="headerlink" href="#dockerfile-for-build-and-tests" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code> in the root directory of the framework setups the dependencies with conda packages and builds the framework, followed by the execution of the unit tests. The Dockerfile is also used in the automatic build with CI service. The following commands build a docker image <code class="docutils literal notranslate"><span class="pre">lm3</span></code> and run an interactive session with the container.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker build -t lm3 .
<span class="gp">$ </span>docker run --rm -it lm3
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For Windows users: running interactive session with docker in Msys’s bash (incl. Git bash) needs <code class="docutils literal notranslate"><span class="pre">winpty</span></code> command before the above <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> command. Also, if you want to specify the shared volume with <code class="docutils literal notranslate"><span class="pre">-v</span></code> option, you need to use the path starting from <code class="docutils literal notranslate"><span class="pre">//c/</span></code> instead of <code class="docutils literal notranslate"><span class="pre">c:/</span></code>.</p>
</div>
</div>
<div class="section" id="dockerfile-only-with-dependencies">
<span id="id4"></span><h3>Dockerfile only with dependencies<a class="headerlink" href="#dockerfile-only-with-dependencies" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Dockerfile.conda</span></code> configures conda dependencies of Lightmetrica as an docker image. Unlike <code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code>, this image does not build the framework by default. This docker image is useful when you want to share the code with host machine while development.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker build -t lm3_dev -f Dockerfile.conda .
<span class="gp">$ </span>docker run --rm -it lm3_dev
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="changelog.html" class="btn btn-neutral float-left" title="Changelog" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="managing_experiment.html" class="btn btn-neutral float-right" title="Managing experiments" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Hisanari Otsu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>